<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plan Nutricional Safebite Plus</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .btn-juicy {
            background: linear-gradient(135deg, #166534, #15803d);
            box-shadow: 0 4px 15px rgba(22, 101, 52, 0.3);
        }
        
        .btn-juicy:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(22, 101, 52, 0.4);
        }
        
        .recipe-box {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .ingredient-box, .preparation-box {
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .active-btn {
            background: linear-gradient(135deg, #f59e0b, #fbbf24) !important;
            color: white !important;
            border-color: #f59e0b !important;
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4) !important;
        }
        
        .hidden {
            display: none !important;
        }

        /* Circular Progress */
        .circular-progress-wrapper {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto;
        }

        .circular-progress {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .progress-svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 8px 20px rgba(34, 197, 94, 0.2));
        }

        .progress-circle-bg {
            fill: none;
            stroke: #e5e7eb;
            stroke-width: 14;
            stroke-linecap: round;
        }

        .progress-circle-fill {
            fill: none;
            stroke: url(#bananaGradient);
            stroke-width: 14;
            stroke-linecap: round;
            stroke-dasharray: 753.98;
            stroke-dashoffset: 753.98;
            transition: stroke-dashoffset 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
        }

        .progress-emoji {
            font-size: 80px;
            line-height: 1;
            display: block;
            animation: swingBanana 3s ease-in-out infinite;
        }

        @keyframes swingBanana {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(5deg) scale(1.1); }
        }

        .progress-number {
            font-size: 32px;
            font-weight: 900;
            color: #f59e0b;
            text-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
            margin-top: -8px;
        }

        .progress-label {
            font-size: 12px;
            font-weight: bold;
            color: #16a34a;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .meal-checkbox {
            width: 28px;
            height: 28px;
            cursor: pointer;
            accent-color: #22c55e;
            transition: transform 0.2s ease;
        }

        .meal-checkbox:checked {
            transform: scale(1.15);
        }

        .meal-type-badge {
            display: inline-block;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .meal-card {
            transition: all 0.3s ease;
            position: relative;
        }

        .meal-card.completed {
            filter: brightness(1.05);
            border-color: #22c55e !important;
            border-width: 2px !important;
        }

        .meal-card.completed::before {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 16px rgba(34, 197, 94, 0.5);
            z-index: 10;
        }

        .meal-card.completed::after {
            content: 'âœ“';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 40px;
            height: 40px;
            color: white;
            font-weight: bold;
            font-size: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 11;
        }

        /* Modal Styles */
        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .modal-content {
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gradient-to-br from-green-50 via-lime-50 to-yellow-50">
  <div class="min-h-screen p-4 md:p-8">
   <div class="max-w-6xl mx-auto"><div class="text-center mb-8">
     <h1 class="text-4xl md:text-5xl font-black mb-3 bg-gradient-to-r from-green-600 via-lime-500 to-yellow-500 bg-clip-text text-transparent">Safebite Plus ğŸŒ¿</h1>
     <p class="text-lg md:text-xl font-bold text-green-700">ğŸŒ± Dieta 100% Libre de Mariscos â€¢ 7 DÃ­as de Sabor y Salud ğŸŠ</p>
    </div><section class="mb-12 bg-white rounded-3xl p-8 shadow-xl border-4 border-green-100">
     <h2 class="text-2xl font-black text-green-800 mb-6 flex items-center gap-3"><span class="bg-gradient-to-r from-yellow-400 to-orange-400 text-white w-12 h-12 rounded-full flex items-center justify-center">1</span> Selecciona Tu Plan</h2>
     <div id="imc-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
    </section><section id="day-area" class="mb-12 bg-white rounded-3xl p-8 shadow-xl border-4 border-green-100 hidden">
     <h2 class="text-2xl font-black text-green-800 mb-6 flex items-center gap-3"><span class="bg-gradient-to-r from-yellow-400 to-orange-400 text-white w-12 h-12 rounded-full flex items-center justify-center">2</span> Elige Tu DÃ­a ğŸ“…</h2>
     <div id="day-grid" class="grid grid-cols-4 md:grid-cols-7 gap-3"></div>
    </section><section id="menu-area" class="mb-12 bg-white rounded-3xl p-8 shadow-xl border-4 border-dashed border-yellow-200 hidden">
     <div class="text-center mb-8">
      <h2 id="day-title" class="text-4xl font-black text-green-800 inline-block bg-gradient-to-r from-yellow-200 to-green-200 px-8 py-3 rounded-full mb-8"></h2><div class="circular-progress-wrapper">
       <svg class="progress-svg" viewbox="0 0 280 280"><defs>
         <lineargradient id="bananaGradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1" />
         </lineargradient>
        </defs> <circle cx="140" cy="140" r="120" class="progress-circle-bg"></circle> <circle id="progress-fill" cx="140" cy="140" r="120" class="progress-circle-fill"></circle>
       </svg><div class="progress-text"><span class="progress-emoji">ğŸŒ</span>
        <div class="progress-number" id="progress-percent">
         0%
        </div>
        <div class="progress-label">
         Completado
        </div>
       </div>
      </div>
     </div><div id="menu-content" class="space-y-6 mt-12"></div>
    </section><div class="text-center py-8">
     <div class="text-4xl mb-4 space-x-3"><span class="inline-block animate-bounce" style="animation-delay: 0s">ğŸ¥¬</span> <span class="inline-block animate-bounce" style="animation-delay: 0.2s">ğŸ</span> <span class="inline-block animate-bounce" style="animation-delay: 0.4s">ğŸ¥•</span> <span class="inline-block animate-bounce" style="animation-delay: 0.6s">ğŸŠ</span> <span class="inline-block animate-bounce" style="animation-delay: 0.8s">ğŸ«›</span>
     </div>
     <p class="text-lg font-bold text-green-700">Â¡Come sano, vive feliz! ğŸŒˆ</p>
    </div>
   </div>
  </div>

  <div id="congrats-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 transition-opacity duration-300">
    <div class="modal-content bg-white rounded-3xl max-w-1g w-11/12 p-6 md:p-8 shadow-2xl border-4 border-green-400 relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-3 bg-gradient-to-r from-green-400 via-yellow-400 to-orange-400"></div>
        
        <div class="text-center">
            <div class="text-6xl md:text-7xl mb-6 animate-bounce">ğŸ‰ğŸ†ğŸ‰</div>
            <h2 class="text-3xl md:text-4xl font-black text-green-800 mb-6 uppercase tracking-tight">Â¡Felicidades por completar el plan!</h2>
            
            <div class="space-y-5 text-gray-700 text-lg leading-relaxed mb-8 text-justify md:text-center">
                <p>Queremos agradecerte de corazÃ³n por confiar en nosotros y permitirnos acompaÃ±arte en un proceso tan personal e importante. Sabemos que cada paso que diste requiriÃ³ constancia, compromiso y decisiÃ³n, y nos alegra profundamente haber sido parte de ese camino.</p>
                <p>Para todo el equipo de <span class="font-bold text-green-600 text-xl">Safebite Plus</span> ha sido un verdadero placer caminar contigo, compartiendo este proceso con entusiasmo, dedicaciÃ³n y mucho cuidado. Tu confianza y tu experiencia no solo nos inspiran, sino que tambiÃ©n nos impulsan a seguir creciendo como comunidad.</p>
                <p class="font-medium text-green-900 bg-green-50 p-4 rounded-xl border border-green-100">Gracias a personas como tÃº, seguimos aprendiendo, mejorando e innovando cada dÃ­a, con el firme compromiso de ofrecer productos de la mÃ¡s alta calidad y un acompaÃ±amiento cada vez mÃ¡s cercano y humano. Recuerda que aquÃ­ siempre tendrÃ¡s un equipo que cree en ti y en tu bienestar.</p>
            </div>

            <button onclick="closeModal()" class="btn-juicy text-white font-bold py-4 px-12 rounded-full text-xl shadow-lg hover:scale-105 transition-transform hover:shadow-2xl">
                Â¡Gracias a ustedes! ğŸ’š
            </button>
        </div>
    </div>
  </div>

  <script>
        let selectedIMC = null;
        let selectedDayIndex = null;
        const dayNames = ['Lunes', 'Martes', 'MiÃ©rcoles', 'Jueves', 'Viernes', 'SÃ¡bado', 'Domingo'];
        const dayFruits = ['ğŸ', 'ğŸŠ', 'ğŸ‹', 'ğŸ«', 'ğŸŒ', 'ğŸŒ¶ï¸', 'ğŸ¥'];
        const fruitEmojis = ['ğŸ', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ‡', 'ğŸ“', 'ğŸ«', 'ğŸ¥', 'ğŸ‘', 'ğŸ’', 'ğŸ¥­', 'ğŸ'];

        // Meals tracking per day
        let mealCompletion = {};

        const menus = {
            sobrepeso: [
                { day: 'Lunes', tip: 'ğŸ’§ Tip: Bebe 2 litros de agua diaria. Â¡HidrÃ¡tate para adelgazar!', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Tostada sin gluten con aguacate y claras revueltas', desc: 'Desayuno ligero y saciante que aporta grasas saludables', cal: '280 kcal', ingredients: 'Pan sin gluten (1 rebanada), claras de huevo (2), aguacate (1/4), sal.',preparation: 'Tostar el pan, cocinar las claras sin aceite, machacar el aguacate y servir.'},
                    { type: 'Snack AM', time: 'ğŸŒ', name: 'Yogur de coco natural', desc: 'Alternativa sin gluten ni lactosa', cal: '120 kcal',ingredients: 'Pan sin gluten (1 rebanada), claras de huevo (2), aguacate (1/4), sal.',preparation: 'Tostar el pan, cocinar las claras sin aceite, machacar el aguacate y servir.'},
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'SalmÃ³n con quinoa y espÃ¡rragos', desc: 'Plato balanceado que aporta omega-3 y fibra.', cal: '420 kcal', ingredients: 'Pan sin gluten (1 rebanada), claras de huevo (2), aguacate (1/4), sal.',preparation: 'Tostar el pan, cocinar las claras sin aceite, machacar el aguacate y servir.'},
                    { type: 'Snack PM', time: 'ğŸ', name: 'Manzana verde', desc: 'Fruta fresca rica en fibra', cal: '80 kcal', ingredients: 'Pan sin gluten (1 rebanada), claras de huevo (2), aguacate (1/4), sal.',preparation: 'Tostar el pan, cocinar las claras sin aceite, machacar el aguacate y servir.'},
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Crema ligera de calabaza', desc: 'Cena suave, baja en calorÃ­as y reconfortante.', cal: '150 kcal', ingredients: 'Pan sin gluten (1 rebanada), claras de huevo (2), aguacate (1/4), sal.',preparation: 'Tostar el pan, cocinar las claras sin aceite, machacar el aguacate y servir.'}
                ]},
                { day: 'Martes', tip: 'ğŸ¥¢ Tip: Mastica lentamente por 20 minutos.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Batido proteico de fresa y chÃ­a', desc: 'Batido refrescante y nutritivo que aporta proteÃ­na y fibra', cal: '220 kcal', recipe: 'ğŸŒ 1 banana\nğŸ¥š 2 huevos\n\nğŸ¥ Esponjosas!' },
                    { type: 'Snack AM', time: 'ğŸŠ', name: 'Manzana verde', desc: 'Fruta fresca rica en fibra', cal: '80 kcal', recipe: 'ğŸŠ 1 naranja\nğŸ¥œ 15 nueces\n\nğŸŒŸ Vitamina C!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Seco de pollo ligero', desc: 'Plato tradicional adaptado', cal: '400 kcal', recipe: 'ğŸ«˜ 1/2 taza garbanzos\nğŸ¥£ hummus\n\nğŸ¥™ MediterrÃ¡neo!' },
                    { type: 'Snack PM', time: 'ğŸ¥', name: 'Papaya picada', desc: 'Fruta digestiva y refrescante', cal: '110 kcal', recipe: 'ğŸ¥ 2 kiwis\nğŸ¥¥ coco rallado\n\nğŸ’š Tropical!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Tortilla de champiÃ±ones y espÃ¡rragos', desc: 'Cena rica en proteÃ­nas y vegetales, baja en carbohidratos', cal: '350 kcal', recipe: 'ğŸ¦ƒ 150g pavo\nğŸ¥¦ brÃ³coli\n\nğŸ³ Ligero!' }
                ]},
                { day: 'MiÃ©rcoles', tip: 'ğŸš¶ Tip: Camina 30 min despuÃ©s de comer.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Tortilla de maÃ­z con pollo', desc: 'Desayuno prÃ¡ctico y balanceado', cal: '350 kcal', recipe: 'ğŸ« 1 paquete aÃ§aÃ­\nğŸŒ 1 banana\n\nğŸ’œ EnergÃ­a!' },
                    { type: 'Snack AM', time: 'ğŸ‡', name: 'Yogur de coco natural', desc: 'Alternativa sin gluten ni lactosa', cal: '120 kcal', recipe: 'ğŸ‡ 1 taza uvas\nğŸ§€ cottage\n\nğŸ¯ ProteÃ­na!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Ternera salteada con brÃ³coli', desc: 'Plato alto en hierro y proteÃ­na', cal: '400 kcal', recipe: 'ğŸ¥© 150g carne\nğŸ¥¬ lechuga\n\nğŸŒ® Frescos!' },
                    { type: 'Snack PM', time: 'ğŸ‘', name: 'Durazno+Yogur', desc: 'Durazno fresco', cal: '120 kcal', recipe: 'ğŸ‘ 1 durazno\nğŸ¥› yogur\n\nğŸŒ¸ Cremoso!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Ensalada de garbanzos con atÃºn', desc: 'Cena nutritiva con proteÃ­na vegetal y animal', cal: '320 kcal', recipe: 'ğŸŸ 150g merluza\nğŸŒ¿ verduras\n\nğŸ“¦ Saludable!' }
                ]},
                { day: 'Jueves', tip: 'ğŸ’ª Tip: ProteÃ­na en cada comida.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Overnight oats sin gluten', desc: 'Desayuno frÃ­o y prÃ¡ctico, rico en fibra y antioxidantes', cal: '360 kcal', recipe: 'ğŸ  2 rodajas camote\nğŸ¥‘ aguacate\n\nğŸ”¥ Innovador!' },
                    { type: 'Snack AM', time: 'ğŸ“', name: 'Fresas', desc: 'Fresas frescas', cal: '130 kcal', recipe: 'ğŸ“ 8 fresas\nğŸ« chocolate 85%\n\nâ¤ï¸ Lujo!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Lentejas estofadas ligeras', desc: 'Plato vegetal completo que aporta proteÃ­na, hierro y energÃ­a sostenida', cal: '430 kcal', recipe: 'ğŸ— 120g pollo\nğŸ¥¬ repollo\n\nğŸŒ¯ Sabores!' },
                    { type: 'Snack PM', time: 'ğŸ¥­', name: ' Naranja entera', desc: 'Fruta rica en vitamina C y fibra, mejor que el jugo para la saciedad', cal: '100 kcal', recipe: 'ğŸ¥­ 1 mango\nğŸŒ¶ï¸ chile\n\nğŸ”¥ ExplosiÃ³n!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Merluza con calabacÃ­n', desc: 'Cena liviana, rica en proteÃ­na y muy baja en grasa', cal: '280 kcal', recipe: 'ğŸƒ calabaza\nğŸ¥¥ leche coco\n\nğŸ² Reconfortante!' }
                ]},
                { day: 'Viernes', tip: 'ğŸ˜´ Tip: Duerme 7-8 horas.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Panqueque de claras y banano', desc: 'Desayuno dulce y saludable, alto en proteÃ­na y bajo en grasa', cal: '330 kcal', recipe: 'ğŸ«˜ 3 cdas chÃ­a\nğŸ¥¥ coco\n\nâ° Refrescante!' },
                    { type: 'Snack AM', time: 'ğŸ«', name: 'ArÃ¡ndanos', desc: 'Antioxidante', cal: '145 kcal', recipe: 'ğŸ« 1/2 taza\nğŸ¥œ almendras\n\nğŸ’œ Potente!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pasta sin gluten con tomate natural', desc: 'Plato reconfortante adaptado, con carbohidratos controlados y salsa ligera', cal: '420 kcal', recipe: 'ğŸŸ atÃºn\nğŸ¥š huevo\n\nğŸ‡«ğŸ‡· ClÃ¡sica!' },
                    { type: 'Snack PM', time: 'ğŸ’', name: 'JudÃ­as verdes de soya al vapor', desc: 'Snack vegetal rico en proteÃ­na y fibra que ayuda a evitar antojos', cal: '90 kcal', recipe: 'ğŸ’ 1 taza\n\nâ¤ï¸ Dulces!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Fajitas de pollo en lechuga', desc: 'Cena baja en carbohidratos que mantiene el sabor sin usar tortillas tradicionales.', cal: '370 kcal', recipe: 'ğŸ— pollo\nğŸ› curry\n\nğŸ› AromÃ¡tico!' }
                ]},
                { day: 'SÃ¡bado', tip: 'ğŸ½ï¸ Tip: Usa platos pequeÃ±os.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Revuelto de huevo y espinaca', desc: 'Desayuno clÃ¡sico, nutritivo y saciante que aporta vitaminas y proteÃ­na.', cal: '520 kcal', recipe: 'ğŸ¥š 3 huevos\nğŸ… tomate\n\nğŸ³ Sabroso!' },
                    { type: 'Snack AM', time: 'ğŸ§‡', name: 'Durazno+Yogur', desc: 'Pancakes mini', cal: '380 kcal', recipe: 'ğŸ¥ pancakes\nğŸ sirope\n\nğŸ¥ Indulgencia!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Arroz caldoso con mariscos', desc: 'Plato completo que combina proteÃ­na magra y carbohidratos en porciÃ³n controlada.', cal: '680 kcal', recipe: 'ğŸŸ pescado\nğŸŒ½ tortillas\n\nğŸŒ® Festival!' },
                    { type: 'Snack PM', time: 'ğŸ‡', name: 'Naranja entera', desc: 'Fruta rica en vitamina C y fibra, mejor que el jugo para la saciedad', cal: '420 kcal', recipe: 'ğŸ§€ quesos\nğŸ‡ uvas\n\nğŸ· Elegante!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Hamburguesa de res al plato', desc: 'Cena proteica sin pan, ideal para mantener masa muscular sin exceso calÃ³rico', cal: '580 kcal', recipe: 'ğŸ— pechuga\nğŸ¥¬ espinaca\n\nğŸ‘¨â€ğŸ³ Gourmet!' }
                ]},
                { day: 'Domingo', tip: 'ğŸ“‹ Tip: Meal prep el domingo.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Bowl de frutas con semillas', desc: 'Desayuno fresco, hidratante y rico en micronutrientes', cal: '620 kcal', recipe: 'ğŸ¥š huevos\nğŸ¥“ bacon\n\nğŸ³ Domingo!' },
                    { type: 'Snack AM', time: 'ğŸŒ', name: 'Naranja entera', desc: 'Fruta rica en vitamina C y fibra, mejor que el jugo para la saciedad', cal: '420 kcal', recipe: 'ğŸŒ banana\nğŸ¥­ mango\n\nğŸŒ´ Tropical!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Lomo de cerdo con patata y ensalada', desc: 'Plato balanceado que aporta proteÃ­na, energÃ­a y fibra', cal: '750 kcal', recipe: 'ğŸ¥© res\nğŸ— pollo\n\nğŸ”¥ Fiesta!' },
                    { type: 'Snack PM', time: 'ğŸ«', name: 'Chocolate negro', desc: 'PequeÃ±o gusto saludable que ayuda a controlar la ansiedad por lo dulce.', cal: '380 kcal', recipe: 'ğŸ« chocolate\nğŸ“ frutas\n\nğŸ«• DiversiÃ³n!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Sopa de pollo con fideos de arroz', desc: 'Cena reconfortante y ligera, ideal para cerrar la semana sin sobrecargar el cuerpo', cal: '650 kcal', recipe: 'ğŸ• pizza\nğŸ§€ queso\n\nğŸ• Noche!' }
                ]}
            ],
            bajo: [
                { day: 'Lunes', tip: 'ğŸ½ï¸ Tip: Come 5-6 comidas diarias.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Super Bowl Avena', desc: 'Avena cremosa', cal: '520 kcal', recipe: 'ğŸ¥£ 1 taza avena\nğŸŒ banana\n\nğŸ³ EnergÃ©tico!' },
                    { type: 'Snack AM', time: 'ğŸŒ', name: 'Batido Ganador', desc: 'Proteico nutritivo', cal: '380 kcal', recipe: 'ğŸŒ 2 bananas\nğŸ¥œ mantequilla manÃ­\n\nğŸ’ª Poder!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pasta+Pollo', desc: 'Fusilli cremosa', cal: '650 kcal', recipe: 'ğŸ pasta arroz\nğŸ— pollo\n\nğŸ Abundante!' },
                    { type: 'Snack PM', time: 'ğŸ¥‘', name: 'Tostada Aguacate', desc: 'Power snack', cal: '420 kcal', recipe: 'ğŸ pan\nğŸ¥‘ aguacate\n\nğŸ¥‘ Graso!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Risotto Quinoa', desc: 'Con salmÃ³n', cal: '580 kcal', recipe: 'ğŸ«˜ quinoa\nğŸŸ salmÃ³n\n\nğŸ³ Gourmet!' }
                ]},
                { day: 'Martes', tip: 'ğŸ¥‘ Tip: Grasas saludables.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Waffles Banana', desc: 'Con caramelo', cal: '550 kcal', recipe: 'ğŸ§‡ waffles\nğŸŒ banana\n\nğŸ³ Indulgente!' },
                    { type: 'Snack AM', time: 'ğŸ§€', name: 'Queso+Frutas', desc: 'Manchego', cal: '320 kcal', recipe: 'ğŸ§€ queso\nğŸ‡ uvas\n\nğŸ· Gourmet!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Burrito Bowl', desc: 'Mexicano', cal: '680 kcal', recipe: 'ğŸš arroz\nğŸ«˜ frijoles\n\nğŸŒ¯ Fiesta!' },
                    { type: 'Snack PM', time: 'ğŸª', name: 'Galletas Avena', desc: 'Caseras', cal: '350 kcal', recipe: 'ğŸ¥£ avena\nğŸ¥œ almendras\n\nğŸª Dulce!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Pollo Mostaza', desc: 'Con papas', cal: '620 kcal', recipe: 'ğŸ— pollo\nğŸ¥” papas\n\nğŸ³ Cremoso!' }
                ]},
                { day: 'MiÃ©rcoles', tip: 'ğŸ¥¤ Tip: Batidos proteicos.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Benedict', desc: 'Huevos+holandesa', cal: '560 kcal', recipe: 'ğŸ¥š huevos\nğŸ§ˆ holandesa\n\nğŸ‘¨â€ğŸ³ Lujo!' },
                    { type: 'Snack AM', time: 'ğŸ', name: 'Manzana+ManÃ­', desc: 'Abundante', cal: '340 kcal', recipe: 'ğŸ manzana\nğŸ¥œ manÃ­\n\nâ¤ï¸ Crujiente!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Curry Garbanzos', desc: 'Premium', cal: '620 kcal', recipe: 'ğŸ› curry\nğŸ«˜ garbanzos\n\nğŸ› AromÃ¡tico!' },
                    { type: 'Snack PM', time: 'ğŸ¥¤', name: 'Batido Aguacate', desc: 'Con cacao', cal: '380 kcal', recipe: 'ğŸ¥‘ aguacate\nğŸ« cacao\n\nğŸ’š Cremoso!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Costillas', desc: 'Glaseadas', cal: '650 kcal', recipe: 'ğŸ– costillas\nğŸ¯ miel\n\nğŸ”¥ Tierno!' }
                ]},
                { day: 'Jueves', tip: 'â° Tip: Come cada 3 horas.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Granola Bowl', desc: 'Supreme', cal: '530 kcal', recipe: 'ğŸ¥£ granola\nğŸ¥› yogur griego\n\nğŸ¥£ Crujiente!' },
                    { type: 'Snack AM', time: 'ğŸ¥œ', name: 'Mix Frutos', desc: 'Premium', cal: '360 kcal', recipe: 'ğŸ¥œ nueces\nğŸ« arÃ¡ndanos\n\nğŸ Lujo!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Hamburguesa', desc: 'Gourmet', cal: '720 kcal', recipe: 'ğŸ” res\nğŸ§€ queso\n\nğŸ” Carnuda!' },
                    { type: 'Snack PM', time: 'ğŸ§', name: 'Muffin Banana', desc: 'Casero', cal: '320 kcal', recipe: 'ğŸŒ banana\nğŸ¥œ nueces\n\nğŸ§ Esponjoso!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Pad Thai', desc: 'Completo', cal: '600 kcal', recipe: 'ğŸœ fideos\nğŸ— pollo\n\nğŸ¥¢ Bangkok!' }
                ]},
                { day: 'Viernes', tip: 'â›½ Tip: Come antes entrenar.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Crepes Sarraceno', desc: 'Con nutella', cal: '540 kcal', recipe: 'ğŸ¥ crepes\nğŸ« nutella\n\nğŸ¥ FrancÃ©s!' },
                    { type: 'Snack AM', time: 'ğŸ¥›', name: 'Batido Fresa', desc: 'Cremoso', cal: '340 kcal', recipe: 'ğŸ“ fresa\nğŸ¥£ avena\n\nğŸ’— Rosa!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'LasaÃ±a Vegetales', desc: 'Carnuda', cal: '650 kcal', recipe: 'ğŸ lasaÃ±a\nğŸ† berenjena\n\nğŸ‡®ğŸ‡¹ Capas!' },
                    { type: 'Snack PM', time: 'ğŸ¦', name: 'Nice Cream', desc: 'Mango', cal: '280 kcal', recipe: 'ğŸŒ banana\nğŸ¥­ mango\n\nğŸ¨ Helado!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'AlbÃ³ndigas', desc: 'En salsa', cal: '620 kcal', recipe: 'ğŸ– res\nğŸ… salsa\n\nğŸ Comfort!' }
                ]},
                { day: 'SÃ¡bado', tip: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Tip: Come con familia.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Shakshuka', desc: 'Abundante', cal: '520 kcal', recipe: 'ğŸ¥š 3 huevos\nğŸ… tomate\n\nğŸ³ Especiado!' },
                    { type: 'Snack AM', time: 'ğŸ§‡', name: 'Tortitas', desc: 'Con sirope', cal: '380 kcal', recipe: 'ğŸ¥ pancakes\nğŸ sirope\n\nğŸ¥ Brunch!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Tacos Pescado', desc: 'Abundantes', cal: '680 kcal', recipe: 'ğŸŸ pescado\nğŸŒ½ tortillas\n\nğŸŒ® Festival!' },
                    { type: 'Snack PM', time: 'ğŸ‡', name: 'Tabla Quesos', desc: 'Premium', cal: '420 kcal', recipe: 'ğŸ§€ quesos\nğŸ‡ frutas\n\nğŸ· Compartir!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Pechuga Rellena', desc: 'Lujo', cal: '580 kcal', recipe: 'ğŸ— pechuga\nğŸ¥¬ espinaca\n\nğŸ‘¨â€ğŸ³ Elegante!' }
                ]},
                { day: 'Domingo', tip: 'ğŸ“‹ Tip: Planifica semana.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Brunch Premium', desc: 'Completo', cal: '620 kcal', recipe: 'ğŸ¥š huevos\nğŸ¥“ bacon\n\nğŸ³ Domingo!' },
                    { type: 'Snack AM', time: 'ğŸŒ', name: 'Smoothie Bowl', desc: 'Deluxe', cal: '420 kcal', recipe: 'ğŸŒ banana\nğŸ¥­ mango\n\nğŸŒ´ Lujo!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pato Naranja', desc: 'Gourmet', cal: '680 kcal', recipe: 'ğŸ¦† pato\nğŸŠ naranja\n\nğŸ”¥ Elegante!' },
                    { type: 'Snack PM', time: 'ğŸ°', name: 'Brownie', desc: 'Saludable', cal: '340 kcal', recipe: 'ğŸ« chocolate\nğŸ¥œ nueces\n\nğŸ« Decadencia!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Filete+Papas', desc: 'Gratinadas', cal: '720 kcal', recipe: 'ğŸ¥© filete\nğŸ¥” papas\n\nğŸ”¥ Lujo!' }
                ]}
            ],
            normal: [
                { day: 'Lunes', tip: 'ğŸŒˆ Tip: Balance proteÃ­na+carbos.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Omelette', desc: 'De verduras', cal: '380 kcal', recipe: 'ğŸ¥š 3 huevos\nğŸ„ champiÃ±ones\n\nğŸ³ Proteico!' },
                    { type: 'Snack AM', time: 'ğŸ', name: 'Manzana+Almendras', desc: 'Fresca', cal: '180 kcal', recipe: 'ğŸ manzana\nğŸ¥œ almendras\n\nğŸŒŸ Crujiente!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Arroz+Pollo', desc: 'Integral', cal: '520 kcal', recipe: 'ğŸš arroz integral\nğŸ— pollo\n\nğŸ³ Nutritivo!' },
                    { type: 'Snack PM', time: 'ğŸŠ', name: 'Naranja', desc: 'Natural', cal: '90 kcal', recipe: 'ğŸŠ naranja\n\nâœ¨ Vitamina C!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Trucha+BrÃ³coli', desc: 'Al horno', cal: '380 kcal', recipe: 'ğŸŸ trucha\nğŸ¥¦ brÃ³coli\n\nğŸ”¥ Delicado!' }
                ]},
                { day: 'Martes', tip: 'ğŸ¥— Tip: VarÃ­a proteÃ­nas.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Yogur+Granola', desc: 'Griego', cal: '320 kcal', recipe: 'ğŸ¥› yogur\nğŸ¥£ granola\n\nâœ¨ Simple!' },
                    { type: 'Snack AM', time: 'ğŸ¥', name: 'Kiwi', desc: 'Tropical', cal: '110 kcal', recipe: 'ğŸ¥ 2 kiwis\n\nğŸ’š Fresco!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pollo+Papas', desc: 'A la plancha', cal: '480 kcal', recipe: 'ğŸ— pollo\nğŸ¥” papas\n\nğŸ³ Casero!' },
                    { type: 'Snack PM', time: 'ğŸŒ', name: 'PlÃ¡tano+Chocolate', desc: 'Derretido', cal: '220 kcal', recipe: 'ğŸŒ plÃ¡tano\nğŸ« chocolate\n\nâ¤ï¸ Dulce!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Lentejas', desc: 'Guisadas', cal: '320 kcal', recipe: 'ğŸ«˜ lentejas\nğŸ¥• verduras\n\nğŸ² Reconfortante!' }
                ]},
                { day: 'MiÃ©rcoles', tip: 'ğŸŒˆ Tip: Colores variados.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Pan+Queso', desc: 'Integral', cal: '300 kcal', recipe: 'ğŸ pan integral\nğŸ§€ queso\n\nğŸ MediterrÃ¡neo!' },
                    { type: 'Snack AM', time: 'ğŸ‡', name: 'Uvas', desc: 'Frescas', cal: '100 kcal', recipe: 'ğŸ‡ uvas\n\nğŸ¯ Dulces!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Tuna Salad', desc: 'Ensalada', cal: '420 kcal', recipe: 'ğŸŸ atÃºn\nğŸ¥¬ lechuga\n\nğŸ¥— ClÃ¡sica!' },
                    { type: 'Snack PM', time: 'ğŸ‘', name: 'Durazno', desc: 'Natural', cal: '60 kcal', recipe: 'ğŸ‘ durazno\n\nğŸŒ¸ Jugoso!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'TallarÃ­n', desc: 'Integral', cal: '380 kcal', recipe: 'ğŸ tallarÃ­n\nğŸ„ champiÃ±ones\n\nğŸ Vegetariano!' }
                ]},
                { day: 'Jueves', tip: 'ğŸ’§ Tip: HidrataciÃ³n.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Avena+Canela', desc: 'Caliente', cal: '340 kcal', recipe: 'ğŸ¥£ avena\nğŸŒ banana\n\nğŸ³ Calentito!' },
                    { type: 'Snack AM', time: 'ğŸ', name: 'Pera+Nueces', desc: 'Crudas', cal: '160 kcal', recipe: 'ğŸ pera\nğŸ¥œ nueces\n\nğŸ¥„ Elegante!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pollo Horno', desc: 'Con verduras', cal: '520 kcal', recipe: 'ğŸ— pollo\nğŸ¥• zanahorias\n\nğŸ”¥ FÃ¡cil!' },
                    { type: 'Snack PM', time: 'ğŸ’', name: 'Cerezas', desc: 'Crujientes', cal: '80 kcal', recipe: 'ğŸ’ cerezas\n\nâ¤ï¸ Dulces!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'SalmÃ³n', desc: 'Glaseado', cal: '420 kcal', recipe: 'ğŸŸ salmÃ³n\nğŸ¯ miel\n\nğŸ”¥ Elegante!' }
                ]},
                { day: 'Viernes', tip: 'ğŸ¥¢ Tip: Mastica bien.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Huevo Cocido', desc: 'Con tostada', cal: '280 kcal', recipe: 'ğŸ¥š huevos\nğŸ pan\n\nğŸ³ ClÃ¡sico!' },
                    { type: 'Snack AM', time: 'ğŸ«', name: 'ArÃ¡ndanos', desc: 'Frescos', cal: '120 kcal', recipe: 'ğŸ« arÃ¡ndanos\n\nğŸ’œ Antioxidantes!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Pasta Bolognesa', desc: 'Integral', cal: '540 kcal', recipe: 'ğŸ pasta\nğŸ¥© carne\n\nğŸ ClÃ¡sica!' },
                    { type: 'Snack PM', time: 'ğŸ“', name: 'Fresas', desc: 'Naturales', cal: '60 kcal', recipe: 'ğŸ“ fresas\n\nâ¤ï¸ Refrescante!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Pavo Guisado', desc: 'Casero', cal: '380 kcal', recipe: 'ğŸ¦ƒ pavo\nğŸ¥” papas\n\nğŸ² Reconfortante!' }
                ]},
                { day: 'SÃ¡bado', tip: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Tip: Disfruta.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Pancakes', desc: 'Caseros', cal: '420 kcal', recipe: 'ğŸ¥ pancakes\nğŸ sirope\n\nğŸ¥ Delicioso!' },
                    { type: 'Snack AM', time: 'ğŸŠ', name: 'Mandarina', desc: 'Jugosa', cal: '80 kcal', recipe: 'ğŸŠ mandarina\n\nğŸŒŸ CÃ­trica!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Asado Variado', desc: 'A la parrilla', cal: '580 kcal', recipe: 'ğŸ¥© carnes\nğŸ¥— ensalada\n\nğŸ”¥ Festivo!' },
                    { type: 'Snack PM', time: 'ğŸ‰', name: 'SandÃ­a', desc: 'Refrescante', cal: '80 kcal', recipe: 'ğŸ‰ sandÃ­a\n\nğŸ’§ Hidratante!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Pastel Papa', desc: 'Gratinado', cal: '520 kcal', recipe: 'ğŸ¥” papas\nğŸ¥© carne\n\nğŸ”¥ Reconfortante!' }
                ]},
                { day: 'Domingo', tip: 'ğŸ“‹ Tip: Organiza.', meals: [
                    { type: 'Desayuno', time: 'ğŸŒ…', name: 'Desayuno Completo', desc: 'De todo', cal: '480 kcal', recipe: 'ğŸ¥š huevos\nğŸ– jamÃ³n\n\nğŸ³ Completo!' },
                    { type: 'Snack AM', time: 'ğŸ¥', name: 'Kiwi+PiÃ±a', desc: 'Tropical', cal: '130 kcal', recipe: 'ğŸ¥ kiwi\nğŸ piÃ±a\n\nğŸŒ´ Tropical!' },
                    { type: 'Almuerzo', time: 'â˜€ï¸', name: 'Estofado', desc: 'Lento', cal: '520 kcal', recipe: 'ğŸ¥© res\nğŸ¥” papas\n\nğŸ² Delicioso!' },
                    { type: 'Snack PM', time: 'ğŸ', name: 'Manzana Roja', desc: 'Crujiente', cal: '95 kcal', recipe: 'ğŸ manzana\n\nâœ¨ Natural!' },
                    { type: 'Cena', time: 'ğŸŒ™', name: 'Merluza Rellena', desc: 'Gourmet', cal: '420 kcal', recipe: 'ğŸŸ merluza\nğŸ¦ camarones\n\nğŸ”¥ Elegante!' }
                ]}
            ]
        };

        // Initialize meal completion tracking
        function initMealTracking() {
            mealCompletion = {};
            for (let i = 0; i < 7; i++) {
                mealCompletion[i] = {};
                for (let j = 0; j < 5; j++) {
                    mealCompletion[i][j] = false;
                }
            }
        }

        function setIMC(imc, btn) {
            selectedIMC = imc;
            document.querySelectorAll('.imc-btn').forEach(b => b.classList.remove('active-btn'));
            btn.classList.add('active-btn');
            document.getElementById('day-area').classList.remove('hidden');
            document.getElementById('menu-area').classList.add('hidden');
            initMealTracking();
            renderDays();
            setTimeout(() => {
                document.getElementById('day-area').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function renderDays() {
            const grid = document.getElementById('day-grid');
            grid.innerHTML = dayNames.map((day, i) => `
                <button onclick="selectDay(${i}, this)" class="day-btn day-btn-${i} w-full p-3 md:p-4 border-3 border-green-200 rounded-2xl hover:border-yellow-400 transition-all bg-gradient-to-br from-white via-green-50 to-yellow-50 group">
                    <span class="text-2xl md:text-3xl block mb-1 group-hover:scale-125 transition-transform">${dayFruits[i]}</span>
                    <span class="font-bold text-green-800 text-xs md:text-sm block">${day.substring(0,3)}</span>
                </button>
            `).join('');
        }

        function selectDay(dayIndex, btn) {
            selectedDayIndex = dayIndex;
            document.querySelectorAll('[class*="day-btn-"]').forEach(b => b.classList.remove('active-btn'));
            btn.classList.add('active-btn');
            
            const dayData = menus[selectedIMC][dayIndex];
            document.getElementById('day-title').textContent = `${dayFruits[dayIndex]} ${dayData.day}`;
            document.getElementById('menu-area').classList.remove('hidden');
            
            const content = document.getElementById('menu-content');
            const mealColors = [
                'from-yellow-100 to-orange-100',
                'from-green-100 to-lime-100', 
                'from-amber-100 to-yellow-100',
                'from-rose-100 to-pink-100',
                'from-indigo-100 to-purple-100'
            ];
            
            let mealsHTML = dayData.meals.map((meal, index) => `
                <div class="meal-card bg-gradient-to-r ${mealColors[index]} rounded-3xl p-5 shadow-lg border-2 border-white hover:shadow-xl transition-all" id="meal-card-${index}">
                    <div class="flex justify-between items-start">
                        <div class="flex-1 cursor-pointer" onclick="toggleRecipe('recipe-${index}')">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-3xl">${meal.time}</span>
                                <span class="meal-type-badge">${meal.type}</span>
                            </div>
                            <h3 class="text-lg font-bold text-green-900">${meal.name}</h3>
                            <p class="text-green-700 text-sm mt-1">${meal.desc}</p>
                            <span class="inline-block bg-gradient-to-r from-orange-400 to-yellow-400 text-white text-xs font-black px-4 py-2 rounded-full shadow-md mt-2">${meal.cal}</span>
                        </div>
                        <div class="ml-4 flex flex-col items-center gap-2">
                            <input type="checkbox" class="meal-checkbox" id="meal-check-${index}"
                                onchange="toggleMeal(${dayIndex}, ${index}, this)">
                            <label for="meal-check-${index}" class="text-xs font-bold text-green-600">Hecho</label>
                        </div>
                    </div>
                    
                    <div id="recipe-${index}" class="recipe-box hidden">
                        <div class="bg-white/80 backdrop-blur rounded-2xl p-5 mt-3 border-2 border-dashed border-green-300">
                            <div class="flex gap-2 mb-4">
                                <button onclick="toggleIngredients('ingredients-${index}')" class="btn-juicy flex-1 text-white font-bold py-2 px-4 rounded-xl">
                                    ğŸ›’ Ingredientes
                                </button>
                                <button onclick="togglePreparation('preparation-${index}')" class="btn-juicy flex-1 text-white font-bold py-2 px-4 rounded-xl">
                                    ğŸ‘¨â€ğŸ³ PreparaciÃ³n
                                </button>
                            </div>
                            <div id="ingredients-${index}" class="ingredient-box hidden">
                                <h4 class="font-black text-green-800 mb-3">ğŸ›’ Ingredientes</h4>
                                <pre class="whitespace-pre-wrap font-sans text-green-700 text-sm">${meal.ingredients}</pre>
                            </div>
                            <div id="preparation-${index}" class="preparation-box hidden">
                                <h4 class="font-black text-green-800 mb-3">ğŸ‘¨â€ğŸ³ PreparaciÃ³n</h4>
                                <pre class="whitespace-pre-wrap font-sans text-green-700 text-sm">${meal.preparation}</pre>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            mealsHTML += `
                <div class="mt-8 bg-gradient-to-r from-blue-100 via-indigo-100 to-purple-100 rounded-3xl p-6 shadow-xl border-3 border-dashed border-blue-300">
                    <div class="flex items-start gap-4">
                        <span class="text-5xl">ğŸ’¡</span>
                        <div class="flex-1">
                            <h3 class="text-xl font-black text-indigo-900 mb-2">Tip Nutricional</h3>
                            <p class="text-indigo-800 font-semibold">${dayData.tip}</p>
                        </div>
                    </div>
                </div>
            `;
            
            content.innerHTML = mealsHTML;
            
            // Restore checkboxes
            dayData.meals.forEach((_, index) => {
                const checkbox = document.getElementById(`meal-check-${index}`);
                if (checkbox && mealCompletion[dayIndex][index]) {
                    checkbox.checked = true;
                    document.getElementById(`meal-card-${index}`).classList.add('completed');
                }
            });
            
            updateProgress();
            
            setTimeout(() => {
                document.getElementById('menu-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function toggleMeal(dayIndex, mealIndex, checkbox) {
            mealCompletion[dayIndex][mealIndex] = checkbox.checked;
            
            const mealCard = document.getElementById(`meal-card-${mealIndex}`);
            if (checkbox.checked) {
                mealCard.classList.add('completed');
            } else {
                mealCard.classList.remove('completed');
            }
            
            updateProgress();
            checkGlobalCompletion(); // CHECK FOR GLOBAL COMPLETION
        }

        // NEW FUNCTION: Check if ALL meals in ALL days are completed
        function checkGlobalCompletion() {
            if (!selectedIMC) return;

            let allCompleted = true;
            
            // Check all 7 days
            for (let d = 0; d < 7; d++) {
                // Get number of meals for this day (robustness)
                const mealsCount = menus[selectedIMC][d].meals.length;
                
                for (let m = 0; m < mealsCount; m++) {
                    if (!mealCompletion[d][m]) {
                        allCompleted = false;
                        break;
                    }
                }
                if (!allCompleted) break;
            }

            if (allCompleted) {
                setTimeout(() => {
                    document.getElementById('congrats-modal').classList.remove('hidden');
                }, 500); // Small delay for UX
            }
        }

        function closeModal() {
            document.getElementById('congrats-modal').classList.add('hidden');
        }

        function updateProgress() {
            if (selectedDayIndex === null) return;
            
            const dayMeals = mealCompletion[selectedDayIndex];
            const completed = Object.values(dayMeals).filter(Boolean).length;
            const total = Object.keys(dayMeals).length;
            const percentage = Math.round((completed / total) * 100);
            
            // Update progress circle
            const circumference = 753.98;
            const offset = circumference - (percentage / 100) * circumference;
            
            const progressFill = document.getElementById('progress-fill');
            if (progressFill) {
                progressFill.style.strokeDashoffset = offset;
            }
            
            // Update percentage text
            document.getElementById('progress-percent').textContent = percentage + '%';
        }

        function toggleRecipe(id) {
            document.getElementById(id).classList.toggle('hidden');
        }

        function toggleIngredients(id) {
            document.querySelectorAll('[id*="ingredients-"], [id*="preparation-"]').forEach(el => {
                if (el.id !== id) el.classList.add('hidden');
            });
            document.getElementById(id).classList.toggle('hidden');
        }

        function togglePreparation(id) {
            document.querySelectorAll('[id*="ingredients-"], [id*="preparation-"]').forEach(el => {
                if (el.id !== id) el.classList.add('hidden');
            });
            document.getElementById(id).classList.toggle('hidden');
        }

        function renderIMCButtons() {
            const grid = document.getElementById('imc-grid');
            const plans = [
                { id: 'sobrepeso', label: 'Sobrepeso', emoji: 'ğŸ“‰' },
                { id: 'bajo', label: 'Bajo de Peso', emoji: 'ğŸ’ª' },
                { id: 'normal', label: 'Peso Normal', emoji: 'âœ¨' }
            ];
            
            grid.innerHTML = plans.map(plan => `
                <button onclick="setIMC('${plan.id}', this)" class="imc-btn bg-gradient-to-br from-white to-green-50 border-3 border-green-200 rounded-2xl p-6 hover:border-yellow-400 hover:shadow-xl transition-all font-bold text-green-800">
                    <div class="text-4xl mb-2">${plan.emoji}</div>
                    ${plan.label}
                </button>
            `).join('');
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderIMCButtons();
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c4ddfa633b3b602',t:'MTc2OTU3NTg3NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>